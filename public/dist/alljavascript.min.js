var app={};!function(){app=angular.module("MainApp",["ngRoute","ngSanitize","ngResource","ngAnimate","mgcrea.ngStrap"]),app.config(["$routeProvider","$locationProvider",function(e,n){n.html5Mode(!1).hashPrefix("!"),e.when("/",{templateUrl:"/views/index.html",controller:"mainCtrl"}).when("/sample",{templateUrl:"/views/sample/sample.html",controller:"sampleCtrl"}).when("/scrub",{templateUrl:"/views/ScrubDomain/scrubdomain.html",controller:"scrubCtrl"}).when("/verification",{templateUrl:"/views/Vertification/VertifiCation.html",controller:"verificationCtrl"}).otherwise({redirectTo:"/"})}])}();var spinner={},token="XXX";!function(){toastr.options={closeButton:!1,debug:!1,progressBar:!1,positionClass:"toast-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var e={lines:11,length:23,width:8,radius:40,corners:1,rotate:9,color:"#FFF",speed:1,trail:50,shadow:!1,hwaccel:!0,zIndex:2e9,top:"50%",left:"50%"},n=null;spinner.show=function(){var t=document.getElementById("spinner");null==n?n=new Spinner(e).spin(t):n.spin(t),$.blockUI({message:null,overlayCSS:{backgroundColor:"#5c5c5c"}})},spinner.hide=function(){var e=document.getElementById("spinner");n.stop(e),$.unblockUI()}}(),function(){app.controller("globalCtrl",["$scope",function(e){e.pageData=[{Name:"Home"},{Name:"Sample"}],e.directiveTest="HELLO WORLD"}])}(),function(){app.directive("directiveSample",function(){return{restrict:"AEC",replace:!0,require:"ngModel",scope:!0,link:function(e,n,t,r){r.$render=function(){n.empty(),n.append(r.$viewValue)}}}})}(),function(){Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e),this},app.filter("DateTrick",function(){return function(e){if(null!==e){var n=e.addHours(7);return n}return{}}})}(),function(){app.controller("mainCtrl",["$scope","mainService",function(e,n){e.activePage=1,e.initMT=function(){n.GetSample().then(function(n){e.testData=n})}}])}(),function(){app.factory("mainService",["$http","$q",function(e,n){var t={};return t.GetSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample"}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t}])}(),function(){app.controller("sampleCtrl",["$scope","$modal","sampleService",function(e,n,t){e.activePage=2,e.readSampleData=[],e.createSample=function(){t.createSample().then(function(n){"ERROR"!=n?(toastr.success("การบันทึกสำเร็จ","การบันทึกข้อมูล"),e.readSampleData.push(n)):toastr.warning("การบันทึกผิดพลาด"+n,"การบันทึกข้อมูล")})},e.createNewSample=function(){t.createNewSample(e.modalData).then(function(n){"ERROR"!=n?(toastr.success("การบันทึกสำเร็จ","การบันทึกข้อมูล"),e.readSampleData.push(n)):toastr.warning("การปรับปรุงผิดพลาด"+n,"การปรับปรุงผิดพลาด")})},e.modalData={},e.read=function(e,n){t.readSample(e).then(function(e){n(e)})},e.readAllSample=function(){t.readAllSample().then(function(n){"ERROR"!=n?e.readSampleData=n:toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")})},e.updateSample=function(){var n=e.currentID,r=e.currentIndex;t.updateSample(e.modalData,n).then(function(n){"ERROR"!=n?e.readSampleData[r]=e.modalData:toastr.warning("การปรับปรุงผิดพลาด"+n,"การปรับปรุงผิดพลาด")})},e.deleteConfirm=function(t,r){e.currentID=t,e.currentIndex=r,n({scope:e,template:"/views/sample/modal/sampleConfirm.html",show:!0})},e.deleteSample=function(){var n=e.currentID,r=e.currentIndex;t.deleteSample(n).then(function(n){"ERROR"!=n?e.readSampleData.splice(r,1):toastr.warning("การลบผิดพลาด"+n,"การลบผิดพลาด")})},e.checkData=function(){switch(e.modalMode){case"create":e.createNewSample();break;case"edit":e.updateSample()}},e.showSample=function(t,r,a){e.modalMode=t,e.currentID=r,e.currentIndex=a;var o=n({scope:e,template:"/views/sample/modal/sampleModal.html",show:!1});switch(t){case"create":e.modalData={},e.modalData.readOnly=!1,o.$promise.then(o.show);break;case"show":e.read(r,function(n){"ERROR"!=n?(o.$promise.then(o.show),e.modalData=n,e.modalData.bCreate=JSON.parse(n.bCreate),e.modalData.readOnly=!0):toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")});break;case"edit":e.read(r,function(n){"ERROR"!=n?(o.$promise.then(o.show),e.modalData=n,e.modalData.bCreate=JSON.parse(n.bCreate),e.modalData.readOnly=!1):toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")})}}}])}(),function(){app.factory("sampleService",["$http","$q",function(e,n){var t={};return t.createSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample/create",contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t.createNewSample=function(t){spinner.show();var r=n.defer();return e({method:"POST",url:"/sample/createnew",contentType:"application/json; charset=utf-8",data:{Name:t.Name,bCreate:t.bCreate},dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t.readAllSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample/read",contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t.deleteSample=function(t){spinner.show();var r=n.defer();return e({method:"GET",url:"/sample/delete/"+t,contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t.readSample=function(t){spinner.show();var r=n.defer();return e({method:"GET",url:"/sample/read/"+t,contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t.updateSample=function(t,r){spinner.show();var a=n.defer();return e({method:"POST",url:"/sample/update/"+r,data:{Name:t.Name,bCreate:t.bCreate},contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),a.resolve(e)}).error(function(e){spinner.hide(),a.reject(e)}),a.promise},t}])}(),function(){app.factory("searchEngineService",["$http","$q",function(e,n){var t={};return t.addKeyword=function(t){spinner.show();var r=n.defer();return console.log(t),e({method:"POST",url:"/searchengine/addKeyword",contentType:"application/json; charset=utf-8",data:t,dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t}])}(),function(){app.controller("scrubCtrl",["$scope","$modal","scrubService",function(e,n,t){e.Scrub={},e.setScrubDomain=function(){var e="C:/Users/biw/Desktop/ScrubFile/scrubExport.txt";t.setScrubDomain(e).then(function(e){console.log(e)})}}])}(),function(){app.factory("scrubService",["$http","$q",function(e,n){var t={};return t.setScrubDomain=function(t){spinner.show();var r=n.defer();return e({method:"POST",url:"/scrub/setScrubDomain",contentType:"application/json; charset=utf-8",data:{filepath:t},dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t}])}(),function(){app.controller("verificationCtrl",["$scope","$modal","verificationService",function(e,n,t){e.setFilePath=function(){var e=document.getElementById("exampleInputFile").value;if(void 0!==e&&""!=e){var n=e.split("\\"),r="D:/"+n[2];console.log(r),t.FindThisData(r).then(function(e){console.log(e)})}}}])}(),function(){app.factory("verificationService",["$http","$q",function(e,n){var t={};return t.FindThisData=function(t){spinner.show();var r=n.defer();return e({method:"POST",url:"/verification/FindThisData",contentType:"application/json; charset=utf-8",data:{filepath:t},dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t}])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbGphdmFzY3JpcHQuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJoYXNoUHJlZml4Iiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzcGlubmVyIiwidG9rZW4iLCJ0b2FzdHIiLCJvcHRpb25zIiwiY2xvc2VCdXR0b24iLCJkZWJ1ZyIsInByb2dyZXNzQmFyIiwicG9zaXRpb25DbGFzcyIsIm9uY2xpY2siLCJzaG93RHVyYXRpb24iLCJoaWRlRHVyYXRpb24iLCJ0aW1lT3V0IiwiZXh0ZW5kZWRUaW1lT3V0Iiwic2hvd0Vhc2luZyIsImhpZGVFYXNpbmciLCJzaG93TWV0aG9kIiwiaGlkZU1ldGhvZCIsIm9wdFNwaW5lck1vZGFsIiwibGluZXMiLCJsZW5ndGgiLCJ3aWR0aCIsInJhZGl1cyIsImNvcm5lcnMiLCJyb3RhdGUiLCJjb2xvciIsInNwZWVkIiwidHJhaWwiLCJzaGFkb3ciLCJod2FjY2VsIiwiekluZGV4IiwidG9wIiwibGVmdCIsInNwaW5uZXJPYmoiLCJzaG93Iiwic3Bpbm5lcl9kaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiU3Bpbm5lciIsInNwaW4iLCIkIiwiYmxvY2tVSSIsIm1lc3NhZ2UiLCJvdmVybGF5Q1NTIiwiYmFja2dyb3VuZENvbG9yIiwiaGlkZSIsInN0b3AiLCJ1bmJsb2NrVUkiLCIkc2NvcGUiLCJwYWdlRGF0YSIsIk5hbWUiLCJkaXJlY3RpdmVUZXN0IiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwicmVxdWlyZSIsInNjb3BlIiwibGluayIsImVsZW1lbnQiLCJhdHRyIiwibmdNb2RlbCIsIiRyZW5kZXIiLCJlbXB0eSIsImFwcGVuZCIsIiR2aWV3VmFsdWUiLCJEYXRlIiwicHJvdG90eXBlIiwiYWRkSG91cnMiLCJoIiwidGhpcyIsInNldEhvdXJzIiwiZ2V0SG91cnMiLCJmaWx0ZXIiLCJpbnB1dCIsIkRhdGVDYWwiLCJtYWluU2VydmljZSIsImFjdGl2ZVBhZ2UiLCJpbml0TVQiLCJHZXRTYW1wbGUiLCJ0aGVuIiwiZGF0YSIsInRlc3REYXRhIiwiZmFjdG9yeSIsIiRodHRwIiwiJHEiLCJ0aGlzZmFjdCIsImRlZmVyIiwibWV0aG9kIiwidXJsIiwic3VjY2VzcyIsInJlc29sdmUiLCJlcnJvciIsImVyciIsInJlamVjdCIsInByb21pc2UiLCIkbW9kYWwiLCJzYW1wbGVTZXJ2aWNlIiwicmVhZFNhbXBsZURhdGEiLCJjcmVhdGVTYW1wbGUiLCJyZXN1bHQiLCJwdXNoIiwid2FybmluZyIsImNyZWF0ZU5ld1NhbXBsZSIsIm1vZGFsRGF0YSIsInJlYWQiLCJpZCIsImNiIiwicmVhZFNhbXBsZSIsInJlYWRBbGxTYW1wbGUiLCJ1cGRhdGVTYW1wbGUiLCJjdXJyZW50SUQiLCJpbmRleCIsImN1cnJlbnRJbmRleCIsImRlbGV0ZUNvbmZpcm0iLCJ0ZW1wbGF0ZSIsImRlbGV0ZVNhbXBsZSIsInNwbGljZSIsImNoZWNrRGF0YSIsIm1vZGFsTW9kZSIsInNob3dTYW1wbGUiLCJ0eXBlIiwibXlPdGhlck1vZGFsIiwicmVhZE9ubHkiLCIkcHJvbWlzZSIsImJDcmVhdGUiLCJKU09OIiwicGFyc2UiLCJjb250ZW50VHlwZSIsImRhdGFUeXBlIiwiaGVhZGVycyIsIlJlcXVlc3RWZXJpZmljYXRpb25Ub2tlbiIsIm9iaiIsImFkZEtleXdvcmQiLCJjb25zb2xlIiwibG9nIiwic2NydWJTZXJ2aWNlIiwiU2NydWIiLCJzZXRTY3J1YkRvbWFpbiIsIkZpbGVwYXRoIiwiZmlsZXBhdGgiLCJ2ZXJpZmljYXRpb25TZXJ2aWNlIiwic2V0RmlsZVBhdGgiLCJnZXRmaWxlcGF0aCIsInZhbHVlIiwidW5kZWZpbmVkIiwiZmlsZSIsInNwbGl0IiwiRmluZFRoaXNEYXRhIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxTQUNKLFdBQ1FBLElBQU1DLFFBQVFDLE9BQU8sV0FBWSxVQUFXLGFBQWMsYUFBYyxZQUFhLG1CQUNyRkYsSUFBSUcsUUFBQSxpQkFBQSxvQkFBTyxTQUFVQyxFQUFnQkMsR0FDakNBLEVBQWtCQyxXQUFVLEdBQU9DLFdBQVcsS0FDOUNILEVBQ0NJLEtBQUssS0FDRkMsWUFBYSxvQkFBcUJDLFdBQVksYUFDL0NGLEtBQUssV0FDSkMsWUFBYSw0QkFBNkJDLFdBQVksZUFDdkRGLEtBQUssVUFDSkMsWUFBYSxzQ0FBdUNDLFdBQVksY0FDakVGLEtBQUssaUJBQ0pDLFlBQWEsMENBQTJDQyxXQUFZLHFCQUNyRUMsV0FDQ0MsV0FBWSxXQUs1QixJQUFJQyxZQUNBQyxNQUFRLE9BQ1osV0FDSUMsT0FBT0MsU0FDSEMsYUFBZSxFQUNmQyxPQUFTLEVBQ1RDLGFBQWUsRUFDZkMsY0FBaUIscUJBQ2pCQyxRQUFXLEtBQ1hDLGFBQWdCLE1BQ2hCQyxhQUFnQixPQUNoQkMsUUFBVyxPQUNYQyxnQkFBbUIsT0FDbkJDLFdBQWMsUUFDZEMsV0FBYyxTQUNkQyxXQUFjLFNBQ2RDLFdBQWMsVUFFbEIsSUFBSUMsSUFDQUMsTUFBTyxHQUNQQyxPQUFRLEdBQ1JDLE1BQU8sRUFDUEMsT0FBUSxHQUNSQyxRQUFTLEVBQ1RDLE9BQVEsRUFDUkMsTUFBTyxPQUNQQyxNQUFPLEVBQ1BDLE1BQU8sR0FDUEMsUUFBUSxFQUNSQyxTQUFTLEVBRVRDLE9BQVEsSUFDUkMsSUFBSyxNQUNMQyxLQUFNLE9BR05DLEVBQWEsSUFDakJoQyxTQUFRaUMsS0FBTyxXQUNYLEdBQUlDLEdBQWNDLFNBQVNDLGVBQWUsVUFDeEIsT0FBZEosRUFDQUEsRUFBYSxHQUFJSyxTQUFRcEIsR0FBZ0JxQixLQUFLSixHQUU5Q0YsRUFBV00sS0FBS0osR0FFcEJLLEVBQUVDLFNBQVNDLFFBQVMsS0FBTUMsWUFBYUMsZ0JBQWlCLGNBRzVEM0MsUUFBUTRDLEtBQU8sV0FDWCxHQUFJVixHQUFjQyxTQUFTQyxlQUFlLFVBQzFDSixHQUFXYSxLQUFLWCxHQUNoQkssRUFBRU8sZ0JBR1YsV0FDSTNELElBQUlVLFdBQVcsY0FBQSxTQUFjLFNBQVVrRCxHQUNuQ0EsRUFBT0MsV0FDRkMsS0FBTSxTQUNOQSxLQUFNLFdBRVhGLEVBQU9HLGNBQWdCLG9CQUcvQixXQUNJL0QsSUFBSWdFLFVBQVUsa0JBQWtCLFdBQzVCLE9BQ0lDLFNBQVUsTUFDVkMsU0FBUyxFQUNUQyxRQUFTLFVBQ1RDLE9BQU8sRUFHUEMsS0FBTSxTQUFVRCxFQUFPRSxFQUFTQyxFQUFNQyxHQUNsQ0EsRUFBUUMsUUFBVSxXQUNkSCxFQUFRSSxRQUNSSixFQUFRSyxPQUFPSCxFQUFRSSxvQkFNM0MsV0FDSUMsS0FBS0MsVUFBVUMsU0FBVSxTQUFTQyxHQUU5QixNQURBQyxNQUFLQyxTQUFTRCxLQUFLRSxXQUFXSCxHQUN2QkMsTUFFWGpGLElBQUlvRixPQUFPLFlBQWEsV0FDcEIsTUFBTyxVQUFVQyxHQUNiLEdBQWMsT0FBVkEsRUFBZ0IsQ0FDaEIsR0FBSUMsR0FBVUQsRUFBTU4sU0FBUyxFQUM3QixPQUFPTyxHQUVQLGVBS2hCLFdBQ0l0RixJQUFJVSxXQUFXLFlBQUEsU0FBQSxjQUFZLFNBQVVrRCxFQUFPMkIsR0FDeEMzQixFQUFPNEIsV0FBYSxFQUNwQjVCLEVBQU82QixPQUFTLFdBQ1pGLEVBQVlHLFlBQVlDLEtBQUssU0FBVUMsR0FDbkNoQyxFQUFPaUMsU0FBV0QsV0FLbEMsV0FDSTVGLElBQUk4RixRQUFRLGVBQUEsUUFBQSxLQUFlLFNBQVVDLEVBQU1DLEdBQ3ZDLEdBQUlDLEtBZ0JKLE9BZkFBLEdBQVNQLFVBQVksV0FDakI3RSxRQUFRaUMsTUFDUixJQUFJb0QsR0FBUUYsRUFBR0UsT0FVZixPQVRBSCxJQUFPSSxPQUFRLE1BQU9DLElBQUssWUFDdkJDLFFBQVEsU0FBU1QsR0FDYi9FLFFBQVE0QyxPQUNSeUMsRUFBTUksUUFBUVYsS0FFbEJXLE1BQU0sU0FBU0MsR0FDWDNGLFFBQVE0QyxPQUNSeUMsRUFBTU8sT0FBT0QsS0FFZE4sRUFBTVEsU0FHVlQsUUFJZixXQUNJakcsSUFBSVUsV0FBVyxjQUFBLFNBQUEsU0FBQSxnQkFBYyxTQUFVa0QsRUFBUStDLEVBQVFDLEdBQ25EaEQsRUFBTzRCLFdBQWEsRUFDcEI1QixFQUFPaUQsa0JBR1BqRCxFQUFPa0QsYUFBZSxXQUNsQkYsRUFBY0UsZUFBZW5CLEtBQUssU0FBVW9CLEdBQzFCLFNBQVZBLEdBQ0FoRyxPQUFPc0YsUUFBUSxrQkFBbUIsbUJBQ2xDekMsRUFBT2lELGVBQWVHLEtBQUtELElBRTNCaEcsT0FBT2tHLFFBQVEsbUJBQXFCRixFQUFRLHNCQUl4RG5ELEVBQU9zRCxnQkFBa0IsV0FDckJOLEVBQWNNLGdCQUFnQnRELEVBQU91RCxXQUFXeEIsS0FBSyxTQUFVb0IsR0FDN0MsU0FBVkEsR0FDQWhHLE9BQU9zRixRQUFRLGtCQUFtQixtQkFDbEN6QyxFQUFPaUQsZUFBZUcsS0FBS0QsSUFFM0JoRyxPQUFPa0csUUFBUSxxQkFBdUJGLEVBQVEseUJBTzFEbkQsRUFBT3VELGFBQ1B2RCxFQUFPd0QsS0FBTyxTQUFVQyxFQUFJQyxHQUN4QlYsRUFBY1csV0FBV0YsR0FBSTFCLEtBQUssU0FBVW9CLEdBQ3hDTyxFQUFHUCxNQUdYbkQsRUFBTzRELGNBQWdCLFdBQ25CWixFQUFjWSxnQkFBZ0I3QixLQUFLLFNBQVVvQixHQUMzQixTQUFWQSxFQUNBbkQsRUFBT2lELGVBQWlCRSxFQUV4QmhHLE9BQU9rRyxRQUFRLHVCQUF5QkYsRUFBUSwyQkFTNURuRCxFQUFPNkQsYUFBZSxXQUNsQixHQUFJSixHQUFLekQsRUFBTzhELFVBQ1pDLEVBQVEvRCxFQUFPZ0UsWUFDbkJoQixHQUFjYSxhQUFhN0QsRUFBT3VELFVBQVdFLEdBQUkxQixLQUFLLFNBQVVvQixHQUM5QyxTQUFWQSxFQUNBbkQsRUFBT2lELGVBQWVjLEdBQVMvRCxFQUFPdUQsVUFFdENwRyxPQUFPa0csUUFBUSxxQkFBdUJGLEVBQVEseUJBTzFEbkQsRUFBT2lFLGNBQWdCLFNBQVVSLEVBQUlNLEdBQ2pDL0QsRUFBTzhELFVBQVlMLEVBQ25CekQsRUFBT2dFLGFBQWVELEVBQ3RCaEIsR0FBUXZDLE1BQU9SLEVBQVFrRSxTQUFVLHlDQUEwQ2hGLE1BQU0sS0FFckZjLEVBQU9tRSxhQUFlLFdBQ2xCLEdBQUlWLEdBQUt6RCxFQUFPOEQsVUFDWkMsRUFBUS9ELEVBQU9nRSxZQUVuQmhCLEdBQWNtQixhQUFhVixHQUFJMUIsS0FBSyxTQUFVb0IsR0FDNUIsU0FBVkEsRUFDQW5ELEVBQU9pRCxlQUFlbUIsT0FBT0wsRUFBTyxHQUVwQzVHLE9BQU9rRyxRQUFRLGVBQWlCRixFQUFRLG1CQU9wRG5ELEVBQU9xRSxVQUFZLFdBQ2YsT0FBUXJFLEVBQU9zRSxXQUNYLElBQUssU0FDRHRFLEVBQU9zRCxpQkFDUCxNQUNKLEtBQUssT0FDRHRELEVBQU82RCxpQkFJbkI3RCxFQUFPdUUsV0FBYSxTQUFVQyxFQUFNZixFQUFJTSxHQUNwQy9ELEVBQU9zRSxVQUFZRSxFQUNuQnhFLEVBQU84RCxVQUFZTCxFQUNuQnpELEVBQU9nRSxhQUFlRCxDQUN0QixJQUFJVSxHQUFlMUIsR0FBUXZDLE1BQU9SLEVBQVFrRSxTQUFVLHVDQUF3Q2hGLE1BQU0sR0FFbEcsUUFBUXNGLEdBQ0osSUFBSyxTQUNEeEUsRUFBT3VELGFBQ1B2RCxFQUFPdUQsVUFBVW1CLFVBQVcsRUFDNUJELEVBQWFFLFNBQVM1QyxLQUFLMEMsRUFBYXZGLEtBQ3hDLE1BQ0osS0FBSyxPQUNEYyxFQUFPd0QsS0FBS0MsRUFBSSxTQUFVTixHQUNSLFNBQVZBLEdBQ0FzQixFQUFhRSxTQUFTNUMsS0FBSzBDLEVBQWF2RixNQUN4Q2MsRUFBT3VELFVBQVlKLEVBQ25CbkQsRUFBT3VELFVBQVVxQixRQUFVQyxLQUFLQyxNQUFNM0IsRUFBT3lCLFNBQzdDNUUsRUFBT3VELFVBQVVtQixVQUFXLEdBRTVCdkgsT0FBT2tHLFFBQVEsdUJBQXlCRixFQUFRLHlCQUl4RCxNQUNKLEtBQUssT0FDRG5ELEVBQU93RCxLQUFLQyxFQUFJLFNBQVVOLEdBQ1IsU0FBVkEsR0FDQXNCLEVBQWFFLFNBQVM1QyxLQUFLMEMsRUFBYXZGLE1BQ3hDYyxFQUFPdUQsVUFBWUosRUFDbkJuRCxFQUFPdUQsVUFBVXFCLFFBQVVDLEtBQUtDLE1BQU0zQixFQUFPeUIsU0FDN0M1RSxFQUFPdUQsVUFBVW1CLFVBQVcsR0FFNUJ2SCxPQUFPa0csUUFBUSx1QkFBeUJGLEVBQVEsa0NBVTVFLFdBQ0kvRyxJQUFJOEYsUUFBUSxpQkFBQSxRQUFBLEtBQWlCLFNBQVVDLEVBQU1DLEdBQ3pDLEdBQUlDLEtBa0lKLE9BaklBQSxHQUFTYSxhQUFlLFdBQ3BCakcsUUFBUWlDLE1BQ1IsSUFBSW9ELEdBQVFGLEVBQUdFLE9BZ0JmLE9BZklILElBQ0lJLE9BQVEsTUFDUkMsSUFBSyxpQkFDTHVDLFlBQWEsa0NBQ2JDLFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCaEksU0FFakN1RixRQUFRLFNBQVNULEdBQ2hCL0UsUUFBUTRDLE9BQ1J5QyxFQUFNSSxRQUFRVixLQUNmVyxNQUFNLFNBQVNYLEdBQ2QvRSxRQUFRNEMsT0FDUnlDLEVBQU1PLE9BQU9iLEtBRWRNLEVBQU1RLFNBR2pCVCxFQUFTaUIsZ0JBQWtCLFNBQVM2QixHQUNoQ2xJLFFBQVFpQyxNQUNSLElBQUlvRCxHQUFRRixFQUFHRSxPQWlCZixPQWhCQUgsSUFDSUksT0FBUSxPQUNSQyxJQUFLLG9CQUNMdUMsWUFBYSxrQ0FDYi9DLE1BQVE5QixLQUFNaUYsRUFBSWpGLEtBQU0wRSxRQUFTTyxFQUFJUCxTQUNyQ0ksU0FBVSxPQUNWQyxTQUNJQyx5QkFBNEJoSSxTQUVqQ3VGLFFBQVEsU0FBU1QsR0FDaEIvRSxRQUFRNEMsT0FDUnlDLEVBQU1JLFFBQVFWLEtBQ2ZXLE1BQU0sU0FBU1gsR0FDZC9FLFFBQVE0QyxPQUNSeUMsRUFBTU8sT0FBT2IsS0FFVk0sRUFBTVEsU0FHakJULEVBQVN1QixjQUFnQixXQUNyQjNHLFFBQVFpQyxNQUNSLElBQUlvRCxHQUFRRixFQUFHRSxPQWlCZixPQWhCSUgsSUFFSUksT0FBUSxNQUNSQyxJQUFLLGVBQ0x1QyxZQUFhLGtDQUNiQyxTQUFVLE9BQ1ZDLFNBQ0lDLHlCQUE0QmhJLFNBRWpDdUYsUUFBUSxTQUFTVCxHQUNoQi9FLFFBQVE0QyxPQUNSeUMsRUFBTUksUUFBUVYsS0FDZlcsTUFBTSxTQUFTWCxHQUNkL0UsUUFBUTRDLE9BQ1J5QyxFQUFNTyxPQUFPYixLQUVkTSxFQUFNUSxTQUdqQlQsRUFBUzhCLGFBQWUsU0FBU1YsR0FDN0J4RyxRQUFRaUMsTUFDUixJQUFJb0QsR0FBUUYsRUFBR0UsT0FnQmYsT0FmSUgsSUFDSUksT0FBUSxNQUNSQyxJQUFLLGtCQUFrQmlCLEVBQ3ZCc0IsWUFBYSxrQ0FDYkMsU0FBVSxPQUNWQyxTQUNJQyx5QkFBNEJoSSxTQUVqQ3VGLFFBQVEsU0FBU1QsR0FDaEIvRSxRQUFRNEMsT0FDUnlDLEVBQU1JLFFBQVFWLEtBQ2ZXLE1BQU0sU0FBU1gsR0FDZC9FLFFBQVE0QyxPQUNSeUMsRUFBTU8sT0FBT2IsS0FFZE0sRUFBTVEsU0FHakJULEVBQVNzQixXQUFhLFNBQVNGLEdBQzNCeEcsUUFBUWlDLE1BQ1IsSUFBSW9ELEdBQVFGLEVBQUdFLE9BZ0JmLE9BZklILElBQ0lJLE9BQVEsTUFDUkMsSUFBSyxnQkFBZ0JpQixFQUNyQnNCLFlBQWEsa0NBQ2JDLFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCaEksU0FFakN1RixRQUFRLFNBQVNULEdBQ2hCL0UsUUFBUTRDLE9BQ1J5QyxFQUFNSSxRQUFRVixLQUNmVyxNQUFNLFNBQVNYLEdBQ2QvRSxRQUFRNEMsT0FDUnlDLEVBQU1PLE9BQU9iLEtBRWRNLEVBQU1RLFNBR2pCVCxFQUFTd0IsYUFBZSxTQUFTc0IsRUFBSTFCLEdBQ2pDeEcsUUFBUWlDLE1BQ1IsSUFBSW9ELEdBQVFGLEVBQUdFLE9BaUJmLE9BaEJJSCxJQUNJSSxPQUFRLE9BQ1JDLElBQUssa0JBQWtCaUIsRUFDdkJ6QixNQUFROUIsS0FBTWlGLEVBQUlqRixLQUFNMEUsUUFBU08sRUFBSVAsU0FDckNHLFlBQWEsa0NBQ2JDLFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCaEksU0FFakN1RixRQUFRLFNBQVNULEdBQ2hCL0UsUUFBUTRDLE9BQ1J5QyxFQUFNSSxRQUFRVixLQUNmVyxNQUFNLFNBQVNYLEdBQ2QvRSxRQUFRNEMsT0FDUnlDLEVBQU1PLE9BQU9iLEtBRWRNLEVBQU1RLFNBR1ZULFFBSWYsV0FDSWpHLElBQUk4RixRQUFRLHVCQUFBLFFBQUEsS0FBdUIsU0FBVUMsRUFBTUMsR0FDL0MsR0FBSUMsS0F3QkosT0F2QkFBLEdBQVMrQyxXQUFhLFNBQVNwRCxHQUMzQi9FLFFBQVFpQyxNQUNSLElBQUlvRCxHQUFRRixFQUFHRSxPQWtCZixPQWpCQStDLFNBQVFDLElBQUl0RCxHQUNaRyxHQUNJSSxPQUFRLE9BQ1JDLElBQUssMkJBQ0x1QyxZQUFhLGtDQUNiL0MsS0FBT0EsRUFDUGdELFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCaEksU0FFakN1RixRQUFRLFNBQVNULEdBQ2hCL0UsUUFBUTRDLE9BQ1J5QyxFQUFNSSxRQUFRVixLQUNmVyxNQUFNLFNBQVNYLEdBQ2QvRSxRQUFRNEMsT0FDUnlDLEVBQU1PLE9BQU9iLEtBRVZNLEVBQU1RLFNBR1ZULFFBR2YsV0FDSWpHLElBQUlVLFdBQVcsYUFBQSxTQUFBLFNBQUEsZUFBYSxTQUFVa0QsRUFBUStDLEVBQVF3QyxHQUVsRHZGLEVBQU93RixTQUNQeEYsRUFBT3lGLGVBQWlCLFdBQ3BCLEdBQUlDLEdBQVcsZ0RBQ2ZILEdBQWFFLGVBQWVDLEdBQVUzRCxLQUFLLFNBQVM0RCxHQUNoRE4sUUFBUUMsSUFBSUssWUFNNUIsV0FDSXZKLElBQUk4RixRQUFRLGdCQUFBLFFBQUEsS0FBZ0IsU0FBVUMsRUFBTUMsR0FDeEMsR0FBSUMsS0F1QkosT0FyQkFBLEdBQVNvRCxlQUFpQixTQUFTTixHQUMvQmxJLFFBQVFpQyxNQUNSLElBQUlvRCxHQUFRRixFQUFHRSxPQWlCZixPQWhCQUgsSUFDSUksT0FBUSxPQUNSQyxJQUFLLHdCQUNMdUMsWUFBYSxrQ0FDYi9DLE1BQVEyRCxTQUFVUixHQUNsQkgsU0FBVSxPQUNWQyxTQUNJQyx5QkFBNEJoSSxTQUVqQ3VGLFFBQVEsU0FBU1QsR0FDaEIvRSxRQUFRNEMsT0FDUnlDLEVBQU1JLFFBQVFWLEtBQ2ZXLE1BQU0sU0FBU1gsR0FDZC9FLFFBQVE0QyxPQUNSeUMsRUFBTU8sT0FBT2IsS0FFVk0sRUFBTVEsU0FFVlQsUUFJZixXQUNJakcsSUFBSVUsV0FBVyxvQkFBQSxTQUFBLFNBQUEsc0JBQW9CLFNBQVVrRCxFQUFRK0MsRUFBUTZDLEdBRXpENUYsRUFBTzZGLFlBQWMsV0FDakIsR0FBSUMsR0FBYzFHLFNBQVNDLGVBQWUsb0JBQW9CMEcsS0FDOUQsSUFBa0JDLFNBQWZGLEdBQXlDLElBQWJBLEVBQWdCLENBQzNDLEdBQUlHLEdBQU9ILEVBQVlJLE1BQU0sTUFDekJQLEVBQVcsTUFBUU0sRUFBSyxFQUM1QlosU0FBUUMsSUFBSUssR0FDWkMsRUFBb0JPLGFBQWFSLEdBQVU1RCxLQUFLLFNBQVNDLEdBQ3JEcUQsUUFBUUMsSUFBSXRELGFBT2hDLFdBQ0k1RixJQUFJOEYsUUFBUSx1QkFBQSxRQUFBLEtBQXVCLFNBQVVDLEVBQU1DLEdBQy9DLEdBQUlDLEtBdUJKLE9BckJBQSxHQUFTOEQsYUFBZSxTQUFTaEIsR0FDN0JsSSxRQUFRaUMsTUFDUixJQUFJb0QsR0FBUUYsRUFBR0UsT0FpQmYsT0FoQkFILElBQ0lJLE9BQVEsT0FDUkMsSUFBSyw2QkFDTHVDLFlBQWEsa0NBQ2IvQyxNQUFRMkQsU0FBVVIsR0FDbEJILFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCaEksU0FFakN1RixRQUFRLFNBQVNULEdBQ2hCL0UsUUFBUTRDLE9BQ1J5QyxFQUFNSSxRQUFRVixLQUNmVyxNQUFNLFNBQVNYLEdBQ2QvRSxRQUFRNEMsT0FDUnlDLEVBQU1PLE9BQU9iLEtBRVZNLEVBQU1RLFNBRVZUIiwiZmlsZSI6ImFsbGphdmFzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgYXBwID0ge307XHJcbihmdW5jdGlvbigpIHtcclxuICAgICAgICBhcHAgPSBhbmd1bGFyLm1vZHVsZShcIk1haW5BcHBcIiwgWyduZ1JvdXRlJywgJ25nU2FuaXRpemUnLCAnbmdSZXNvdXJjZScsICduZ0FuaW1hdGUnLCAnbWdjcmVhLm5nU3RyYXAnXSk7XHJcbiAgICAgICAgYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZShmYWxzZSkuaGFzaFByZWZpeCgnIScpO1xyXG4gICAgICAgICAgICAkcm91dGVQcm92aWRlclxyXG4gICAgICAgICAgICAud2hlbihcIi9cIix7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9pbmRleC5odG1sJywgY29udHJvbGxlcjogJ21haW5DdHJsJ1xyXG4gICAgICAgICAgICB9KS53aGVuKFwiL3NhbXBsZVwiLHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NhbXBsZS9zYW1wbGUuaHRtbCcsIGNvbnRyb2xsZXI6ICdzYW1wbGVDdHJsJ1xyXG4gICAgICAgICAgICB9KS53aGVuKFwiL3NjcnViXCIse1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvU2NydWJEb21haW4vc2NydWJkb21haW4uaHRtbCcsIGNvbnRyb2xsZXI6ICdzY3J1YkN0cmwnXHJcbiAgICAgICAgICAgIH0pLndoZW4oXCIvdmVyaWZpY2F0aW9uXCIse1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvVmVydGlmaWNhdGlvbi9WZXJ0aWZpQ2F0aW9uLmh0bWwnLCBjb250cm9sbGVyOiAndmVyaWZpY2F0aW9uQ3RybCdcclxuICAgICAgICAgICAgfSkub3RoZXJ3aXNlKHtcclxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86IFwiL1wiXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4pKCk7XG52YXIgc3Bpbm5lciA9IHt9O1xyXG52YXIgdG9rZW4gPSBcIlhYWFwiO1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICB0b2FzdHIub3B0aW9ucyA9IHtcclxuICAgICAgICBcImNsb3NlQnV0dG9uXCI6IGZhbHNlLFxyXG4gICAgICAgIFwiZGVidWdcIjogZmFsc2UsXHJcbiAgICAgICAgXCJwcm9ncmVzc0JhclwiOiBmYWxzZSxcclxuICAgICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC1ib3R0b20tcmlnaHRcIixcclxuICAgICAgICBcIm9uY2xpY2tcIjogbnVsbCxcclxuICAgICAgICBcInNob3dEdXJhdGlvblwiOiBcIjMwMFwiLFxyXG4gICAgICAgIFwiaGlkZUR1cmF0aW9uXCI6IFwiMTAwMFwiLFxyXG4gICAgICAgIFwidGltZU91dFwiOiBcIjUwMDBcIixcclxuICAgICAgICBcImV4dGVuZGVkVGltZU91dFwiOiBcIjEwMDBcIixcclxuICAgICAgICBcInNob3dFYXNpbmdcIjogXCJzd2luZ1wiLFxyXG4gICAgICAgIFwiaGlkZUVhc2luZ1wiOiBcImxpbmVhclwiLFxyXG4gICAgICAgIFwic2hvd01ldGhvZFwiOiBcImZhZGVJblwiLFxyXG4gICAgICAgIFwiaGlkZU1ldGhvZFwiOiBcImZhZGVPdXRcIlxyXG4gICAgfTtcclxuICAgIHZhciBvcHRTcGluZXJNb2RhbCA9IHtcclxuICAgICAgICBsaW5lczogMTEsIC8vIFRoZSBudW1iZXIgb2YgbGluZXMgdG8gZHJhd1xyXG4gICAgICAgIGxlbmd0aDogMjMsIC8vIFRoZSBsZW5ndGggb2YgZWFjaCBsaW5lXHJcbiAgICAgICAgd2lkdGg6IDgsIC8vIFRoZSBsaW5lIHRoaWNrbmVzc1xyXG4gICAgICAgIHJhZGl1czogNDAsIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxyXG4gICAgICAgIGNvcm5lcnM6IDEsIC8vIENvcm5lciByb3VuZG5lc3MgKDAuLjEpXHJcbiAgICAgICAgcm90YXRlOiA5LCAvLyBUaGUgcm90YXRpb24gb2Zmc2V0XHJcbiAgICAgICAgY29sb3I6ICcjRkZGJywgLy8gI3JnYiBvciAjcnJnZ2JiXHJcbiAgICAgICAgc3BlZWQ6IDEsIC8vIFJvdW5kcyBwZXIgc2Vjb25kXHJcbiAgICAgICAgdHJhaWw6IDUwLCAvLyBBZnRlcmdsb3cgcGVyY2VudGFnZVxyXG4gICAgICAgIHNoYWRvdzogZmFsc2UsIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XHJcbiAgICAgICAgaHdhY2NlbDogdHJ1ZSwgLy8gV2hldGhlciB0byB1c2UgaGFyZHdhcmUgYWNjZWxlcmF0aW9uXHJcbiAgICAgICAgLy9jbGFzc05hbWU6ICdzcGlubmVyJywgLy8gVGhlIENTUyBjbGFzcyB0byBhc3NpZ24gdG8gdGhlIHNwaW5uZXJcclxuICAgICAgICB6SW5kZXg6IDJlOSwgLy8gVGhlIHotaW5kZXggKGRlZmF1bHRzIHRvIDIwMDAwMDAwMDApXHJcbiAgICAgICAgdG9wOiAnNTAlJywgLy8gVG9wIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHBhcmVudCBpbiBweFxyXG4gICAgICAgIGxlZnQ6ICc1MCUnIC8vIExlZnQgcG9zaXRpb24gcmVsYXRpdmUgdG8gcGFyZW50IGluIHB4XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzcGlubmVyT2JqID0gbnVsbDtcclxuICAgIHNwaW5uZXIuc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc3Bpbm5lcl9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3Bpbm5lcicpO1xyXG4gICAgICAgIGlmIChzcGlubmVyT2JqID09IG51bGwpIHtcclxuICAgICAgICAgICAgc3Bpbm5lck9iaiA9IG5ldyBTcGlubmVyKG9wdFNwaW5lck1vZGFsKS5zcGluKHNwaW5uZXJfZGl2KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzcGlubmVyT2JqLnNwaW4oc3Bpbm5lcl9kaXYpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkLmJsb2NrVUkoe21lc3NhZ2U6IG51bGwsIG92ZXJsYXlDU1M6IHtiYWNrZ3JvdW5kQ29sb3I6ICcjNWM1YzVjJ319KTtcclxuICAgIH1cclxuXHJcbiAgICBzcGlubmVyLmhpZGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNwaW5uZXJfZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwaW5uZXInKTtcclxuICAgICAgICBzcGlubmVyT2JqLnN0b3Aoc3Bpbm5lcl9kaXYpO1xyXG4gICAgICAgICQudW5ibG9ja1VJKCk7XHJcbiAgICB9XHJcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XHJcbiAgICBhcHAuY29udHJvbGxlcihcImdsb2JhbEN0cmxcIiwgZnVuY3Rpb24gKCRzY29wZSkge1xyXG4gICAgICAgICRzY29wZS5wYWdlRGF0YSA9IFtcclxuICAgICAgICAgICAge05hbWU6ICdIb21lJ30sXHJcbiAgICAgICAgICAgIHtOYW1lOiAnU2FtcGxlJ31cclxuICAgICAgICBdO1xyXG4gICAgICAgICRzY29wZS5kaXJlY3RpdmVUZXN0ID0gXCJIRUxMTyBXT1JMRFwiO1xyXG4gICAgfSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuICAgIGFwcC5kaXJlY3RpdmUoJ2RpcmVjdGl2ZVNhbXBsZScsZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBRUMnLFxyXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgICAgICAgICAvL3RlbXBsYXRlIDogXCJcIixcclxuICAgICAgICAgICAgLy90ZW1wbGF0ZVVybCA6IFwiXCIsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgbmdNb2RlbCkge1xyXG4gICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZW1wdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFwcGVuZChuZ01vZGVsLiR2aWV3VmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCkge1xyXG4gICAgRGF0ZS5wcm90b3R5cGUuYWRkSG91cnM9IGZ1bmN0aW9uKGgpe1xyXG4gICAgICAgIHRoaXMuc2V0SG91cnModGhpcy5nZXRIb3VycygpK2gpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gICAgYXBwLmZpbHRlcignRGF0ZVRyaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQpIHtcclxuICAgICAgICAgICAgaWYgKGlucHV0ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgRGF0ZUNhbCA9IGlucHV0LmFkZEhvdXJzKDcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGVDYWw7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xuICAgIGFwcC5jb250cm9sbGVyKCdtYWluQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsbWFpblNlcnZpY2UpIHtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZVBhZ2UgPSAxOyAvLyBIb21lXG4gICAgICAgICRzY29wZS5pbml0TVQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIG1haW5TZXJ2aWNlLkdldFNhbXBsZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGVzdERhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcbiAgICBhcHAuZmFjdG9yeSgnbWFpblNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcclxuICAgICAgICB2YXIgdGhpc2ZhY3QgPSB7fTtcclxuICAgICAgICB0aGlzZmFjdC5HZXRTYW1wbGUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcclxuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgJGh0dHAoe21ldGhvZDogJ0dFVCcsIHVybDogJy9zYW1wbGUnfSkuXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuXHJcbiAgICAgICAgICAgICAgICBlcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpc2ZhY3Q7XHJcblxyXG4gICAgfSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XHJcbiAgICBhcHAuY29udHJvbGxlcignc2FtcGxlQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgc2FtcGxlU2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5hY3RpdmVQYWdlID0gMjsgLy9cIlNhbXBsZVwiO1xyXG4gICAgICAgICRzY29wZS5yZWFkU2FtcGxlRGF0YSA9IFtdO1xyXG5cclxuICAgICAgICAvLy8tLS0tLS0tLS0tLS0gQ3JlYXRlIFNlY3Rpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgJHNjb3BlLmNyZWF0ZVNhbXBsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5jcmVhdGVTYW1wbGUoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gXCJFUlJPUlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoJ+C4geC4suC4o+C4muC4seC4meC4l+C4tuC4geC4quC4s+C5gOC4o+C5h+C4iCcsICfguIHguLLguKPguJrguLHguJnguJfguLbguIHguILguYnguK3guKHguLnguKUnKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZFNhbXBsZURhdGEucHVzaChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygn4LiB4Liy4Lij4Lia4Lix4LiZ4LiX4Li24LiB4Lic4Li04LiU4Lie4Lil4Liy4LiUJyArIHJlc3VsdCwgJ+C4geC4suC4o+C4muC4seC4meC4l+C4tuC4geC4guC5ieC4reC4oeC4ueC4pScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNyZWF0ZU5ld1NhbXBsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5jcmVhdGVOZXdTYW1wbGUoJHNjb3BlLm1vZGFsRGF0YSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IFwiRVJST1JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCfguIHguLLguKPguJrguLHguJnguJfguLbguIHguKrguLPguYDguKPguYfguIgnLCAn4LiB4Liy4Lij4Lia4Lix4LiZ4LiX4Li24LiB4LiC4LmJ4Lit4Lih4Li54LilJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlYWRTYW1wbGVEYXRhLnB1c2gocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4m+C4o+C4seC4muC4m+C4o+C4uOC4h+C4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguJvguKPguLHguJrguJvguKPguLjguIfguJzguLTguJTguJ7guKXguLLguJQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLSBSZWFkIFNlY3Rpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgICRzY29wZS5tb2RhbERhdGEgPSB7fTtcclxuICAgICAgICAkc2NvcGUucmVhZCA9IGZ1bmN0aW9uIChpZCwgY2IpIHtcclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5yZWFkU2FtcGxlKGlkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGNiKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUucmVhZEFsbFNhbXBsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5yZWFkQWxsU2FtcGxlKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IFwiRVJST1JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWFkU2FtcGxlRGF0YSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4reC5iOC4suC4meC4guC5ieC4reC4oeC4ueC4peC4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguK3guYjguLLguJnguILguYnguK3guKHguLnguKXguJzguLTguJTguJ7guKXguLLguJQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gOiBQYWdpbmF0aW9uIFNlcnZlcnNpZGUgUmVhZERhdGFcclxuXHJcbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgICAvLy8tLS0tLS0tLS0tLS0tIFVwZGF0ZSBTZWN0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNhbXBsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGlkID0gJHNjb3BlLmN1cnJlbnRJRDtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gJHNjb3BlLmN1cnJlbnRJbmRleDtcclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS51cGRhdGVTYW1wbGUoJHNjb3BlLm1vZGFsRGF0YSwgaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPSBcIkVSUk9SXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZFNhbXBsZURhdGFbaW5kZXhdID0gJHNjb3BlLm1vZGFsRGF0YTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4m+C4o+C4seC4muC4m+C4o+C4uOC4h+C4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguJvguKPguLHguJrguJvguKPguLjguIfguJzguLTguJTguJ7guKXguLLguJQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgICAvLy8tLS0tLS0tLS0tLS0tIERlbGV0ZSBTZWN0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbmZpcm0gPSBmdW5jdGlvbiAoaWQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50SUQgPSBpZDtcclxuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRJbmRleCA9IGluZGV4O1xyXG4gICAgICAgICAgICAkbW9kYWwoe3Njb3BlOiAkc2NvcGUsIHRlbXBsYXRlOiAnL3ZpZXdzL3NhbXBsZS9tb2RhbC9zYW1wbGVDb25maXJtLmh0bWwnLCBzaG93OiB0cnVlfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU2FtcGxlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgaWQgPSAkc2NvcGUuY3VycmVudElEO1xyXG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUuY3VycmVudEluZGV4O1xyXG5cclxuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5kZWxldGVTYW1wbGUoaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPSBcIkVSUk9SXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZFNhbXBsZURhdGEuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4peC4muC4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguKXguJrguJzguLTguJTguJ7guKXguLLguJQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0gT3RoZXIgU2VjdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgICRzY29wZS5jaGVja0RhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoJHNjb3BlLm1vZGFsTW9kZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiIDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY3JlYXRlTmV3U2FtcGxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZWRpdFwiIDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXBkYXRlU2FtcGxlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgJHNjb3BlLnNob3dTYW1wbGUgPSBmdW5jdGlvbiAodHlwZSwgaWQsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICRzY29wZS5tb2RhbE1vZGUgPSB0eXBlO1xyXG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudElEID0gaWQ7XHJcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50SW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgdmFyIG15T3RoZXJNb2RhbCA9ICRtb2RhbCh7c2NvcGU6ICRzY29wZSwgdGVtcGxhdGU6ICcvdmlld3Mvc2FtcGxlL21vZGFsL3NhbXBsZU1vZGFsLmh0bWwnLCBzaG93OiBmYWxzZX0pO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnIDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YS5yZWFkT25seSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIG15T3RoZXJNb2RhbC4kcHJvbWlzZS50aGVuKG15T3RoZXJNb2RhbC5zaG93KTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3Nob3cnIDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZChpZCwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IFwiRVJST1JcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlPdGhlck1vZGFsLiRwcm9taXNlLnRoZW4obXlPdGhlck1vZGFsLnNob3cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YSA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tb2RhbERhdGEuYkNyZWF0ZSA9IEpTT04ucGFyc2UocmVzdWx0LmJDcmVhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YS5yZWFkT25seSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygn4LiB4Liy4Lij4Lit4LmI4Liy4LiZ4LiC4LmJ4Lit4Lih4Li54Lil4Lic4Li04LiU4Lie4Lil4Liy4LiUJyArIHJlc3VsdCwgJ+C4geC4suC4o+C4reC5iOC4suC4meC4guC5ieC4reC4oeC4ueC4peC4nOC4tOC4lOC4nuC4peC4suC4lCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnZWRpdCcgOlxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWFkKGlkLCBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gXCJFUlJPUlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteU90aGVyTW9kYWwuJHByb21pc2UudGhlbihteU90aGVyTW9kYWwuc2hvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YS5iQ3JlYXRlID0gSlNPTi5wYXJzZShyZXN1bHQuYkNyZWF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLnJlYWRPbmx5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygn4LiB4Liy4Lij4Lit4LmI4Liy4LiZ4LiC4LmJ4Lit4Lih4Li54Lil4Lic4Li04LiU4Lie4Lil4Liy4LiUJyArIHJlc3VsdCwgJ+C4geC4suC4o+C4reC5iOC4suC4meC4guC5ieC4reC4oeC4ueC4peC4nOC4tOC4lOC4nuC4peC4suC4lCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIH0pO1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpe1xyXG4gICAgYXBwLmZhY3RvcnkoJ3NhbXBsZVNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcclxuICAgICAgICB2YXIgdGhpc2ZhY3QgPSB7fTtcclxuICAgICAgICB0aGlzZmFjdC5jcmVhdGVTYW1wbGUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcclxuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9jcmVhdGUnLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4nOiB0b2tlblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXNmYWN0LmNyZWF0ZU5ld1NhbXBsZSA9IGZ1bmN0aW9uKG9iail7XHJcbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xyXG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9jcmVhdGVuZXcnLFxyXG4gICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHsgTmFtZTogb2JqLk5hbWUsIGJDcmVhdGU6IG9iai5iQ3JlYXRlfSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXNmYWN0LnJlYWRBbGxTYW1wbGUgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcclxuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9yZWFkJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuJzogdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzZmFjdC5kZWxldGVTYW1wbGUgPSBmdW5jdGlvbihpZCl7XHJcbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xyXG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9kZWxldGUvJytpZCxcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAnUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuJzogdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzZmFjdC5yZWFkU2FtcGxlID0gZnVuY3Rpb24oaWQpe1xyXG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcclxuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9zYW1wbGUvcmVhZC8nK2lkLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4nOiB0b2tlblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXNmYWN0LnVwZGF0ZVNhbXBsZSA9IGZ1bmN0aW9uKG9iaixpZCl7XHJcbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xyXG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS91cGRhdGUvJytpZCxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IE5hbWU6IG9iai5OYW1lLCBiQ3JlYXRlOiBvYmouYkNyZWF0ZX0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXNmYWN0O1xyXG5cclxuICAgIH0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcbiAgICBhcHAuZmFjdG9yeSgnc2VhcmNoRW5naW5lU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwkcSkge1xyXG4gICAgICAgIHZhciB0aGlzZmFjdCA9IHt9O1xyXG4gICAgICAgIHRoaXNmYWN0LmFkZEtleXdvcmQgPSBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XHJcbiAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAkaHR0cCh7XHJcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3NlYXJjaGVuZ2luZS9hZGRLZXl3b3JkJyxcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAgICAgICAgICAgICBkYXRhIDogZGF0YSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzZmFjdDtcclxuICAgIH0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCkge1xyXG4gICAgYXBwLmNvbnRyb2xsZXIoJ3NjcnViQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgc2NydWJTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgICRzY29wZS5TY3J1YiA9e307XHJcbiAgICAgICAgJHNjb3BlLnNldFNjcnViRG9tYWluID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIEZpbGVwYXRoID0gXCJDOi9Vc2Vycy9iaXcvRGVza3RvcC9TY3J1YkZpbGUvc2NydWJFeHBvcnQudHh0XCI7XHJcbiAgICAgICAgICAgIHNjcnViU2VydmljZS5zZXRTY3J1YkRvbWFpbihGaWxlcGF0aCkudGhlbihmdW5jdGlvbihmaWxlcGF0aCl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlcGF0aCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxufSkoKTtcclxuXG4oZnVuY3Rpb24oKXtcclxuICAgIGFwcC5mYWN0b3J5KCdzY3J1YlNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcclxuICAgICAgICB2YXIgdGhpc2ZhY3QgPSB7fTtcclxuXHJcbiAgICAgICAgdGhpc2ZhY3Quc2V0U2NydWJEb21haW4gPSBmdW5jdGlvbihvYmope1xyXG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcclxuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgJGh0dHAoe1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgICAgICAgIHVybDogJy9zY3J1Yi9zZXRTY3J1YkRvbWFpbicsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBmaWxlcGF0aDogb2JqfSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXNmYWN0O1xyXG5cclxuICAgIH0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCkge1xyXG4gICAgYXBwLmNvbnRyb2xsZXIoJ3ZlcmlmaWNhdGlvbkN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWwsIHZlcmlmaWNhdGlvblNlcnZpY2UpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLnNldEZpbGVQYXRoID0gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgdmFyIGdldGZpbGVwYXRoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4YW1wbGVJbnB1dEZpbGUnKS52YWx1ZTtcclxuICAgICAgICAgICAgaWYoZ2V0ZmlsZXBhdGghPT0gdW5kZWZpbmVkICYmIGdldGZpbGVwYXRoIT1cIlwiKXtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZ2V0ZmlsZXBhdGguc3BsaXQoXCJcXFxcXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGZpbGVwYXRoID0gXCJEOi9cIiArIGZpbGVbMl07XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlcGF0aCk7XHJcbiAgICAgICAgICAgICAgICB2ZXJpZmljYXRpb25TZXJ2aWNlLkZpbmRUaGlzRGF0YShmaWxlcGF0aCkudGhlbihmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG59KSgpO1xyXG5cbihmdW5jdGlvbigpe1xyXG4gICAgYXBwLmZhY3RvcnkoJ3ZlcmlmaWNhdGlvblNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcclxuICAgICAgICB2YXIgdGhpc2ZhY3QgPSB7fTtcclxuXHJcbiAgICAgICAgdGhpc2ZhY3QuRmluZFRoaXNEYXRhID0gZnVuY3Rpb24ob2JqKXtcclxuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XHJcbiAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgICRodHRwKHtcclxuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvdmVyaWZpY2F0aW9uL0ZpbmRUaGlzRGF0YScsXHJcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxyXG4gICAgICAgICAgICAgICAgZGF0YTogeyBmaWxlcGF0aDogb2JqfSxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICBkZWZlci5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcclxuICAgICAgICAgICAgICAgIGRlZmVyLnJlamVjdChkYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHRoaXNmYWN0O1xyXG5cclxuICAgIH0pO1xyXG59KSgpOyJdfQ==
